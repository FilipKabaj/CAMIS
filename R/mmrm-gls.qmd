---
title: "Generalized Linear Mixed Models	 R"
---

#### Using the `nlme::gls` function

The code below implements an MMRM fit in R with the `nlme::gls` function.

```{r}
#| eval: false
#| echo: true
gls(model = CHG ~ TRTP + AVISITN + TRTP:AVISITN + AVISITN + BASE,
    data = data,
    correlation = corSymm(form = ~1|SUBJID),
    weights = varIdent(form = ~1|AVISITN),
    control = glsControl(opt = "optim"),
    method = "REML",
    na.action = "na.omit")
```

here we can swap out `corSymm` for `corCompSymm` to give the compound symmetry structure or `corCAR1` for autoregressive of first order (AR(1)).
