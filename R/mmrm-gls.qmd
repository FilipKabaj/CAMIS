---
title: "Generalized Linear Mixed Models	 R"
---

#### Using the `nlme::gls` function

Fitting an MMRM in R is achieved using the `nlme::gls()` function. This is a Generalized Least Squares fitting procedure which allows for bespoke specification of the correlation structure used.

```{r}
#| eval: false
#| echo: true
gls(model = CHG ~ TRTP + AVISITN + TRTP:AVISITN + AVISITN + BASE,
    data = data,
    correlation = corSymm(form = ~1|SUBJID),
    weights = varIdent(form = ~1|AVISITN),
    control = glsControl(opt = "optim"),
    method = "REML",
    na.action = "na.omit")
```

an swap out `corSymm` for `corCompSymm` to give the compound symmetry structure or `corCAR1` for autoregressive of first order (AR(1)).

The specification of the unstructured variance-covariance and the repeated structure for visits comes through via our direct calls to the `correlation = corSymm(form = ~1|SUBJID)` and the `weights = varIdent(form = ~1|AVISITN)`
