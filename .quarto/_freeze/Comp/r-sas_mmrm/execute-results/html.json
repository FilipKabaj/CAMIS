{
  "hash": "fe02ffd79fd72ba3e9025ac0ee4fb4a7",
  "result": {
    "markdown": "---\ntitle: \"R vs SAS MMRM\"\n---\n\n::: {.cell}\n\n:::\n\n\n### Data\n\nThe data used for this comparison was the lab ADaM dataset adlbh.xpt from the Phuse Pilot Study. Results were generated for each lab parameter and time point in the dataset using three different covariance structures, i.e. unstructured, compound symmetry and autoregressive of first order (AR(1)).\n\n### Comparison between SAS and R\n\nWith results available for SAS and R model fits, we turn our attention to generating some visual comparisons of the results. Note that here we adopt a Bland-Altman type plot which plots the difference on the y-axis and the average on the x-axis. This offers a way to inspect any bias or relationships with the size of effect and the associated bias.\n\nFor the extracted LS-means\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](r-sas_mmrm_files/figure-html/unnamed-chunk-2-1.png){width=100%}\n:::\n\n::: {.cell-output-display}\n![](r-sas_mmrm_files/figure-html/unnamed-chunk-2-2.png){width=100%}\n:::\n\n::: {.cell-output-display}\n![](r-sas_mmrm_files/figure-html/unnamed-chunk-2-3.png){width=100%}\n:::\n\n::: {.cell-output-display}\n![](r-sas_mmrm_files/figure-html/unnamed-chunk-2-4.png){width=100%}\n:::\n:::\n\n\nand corresponding SEs\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](r-sas_mmrm_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](r-sas_mmrm_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](r-sas_mmrm_files/figure-html/unnamed-chunk-3-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](r-sas_mmrm_files/figure-html/unnamed-chunk-3-4.png){width=672}\n:::\n:::\n\n\nFor the derived contrasts\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](r-sas_mmrm_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](r-sas_mmrm_files/figure-html/unnamed-chunk-4-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](r-sas_mmrm_files/figure-html/unnamed-chunk-4-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](r-sas_mmrm_files/figure-html/unnamed-chunk-4-4.png){width=672}\n:::\n:::\n\n\nand corresponding 95%CI widths\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](r-sas_mmrm_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](r-sas_mmrm_files/figure-html/unnamed-chunk-5-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](r-sas_mmrm_files/figure-html/unnamed-chunk-5-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](r-sas_mmrm_files/figure-html/unnamed-chunk-5-4.png){width=672}\n:::\n:::\n\n\n### Analysis of SAS and R Comparison\n\nUsing SAS PROC MIXED and R functions such as gls, lmer, mod_grid, and mod_emm, results were broadly aligned. Results not being exact can be attributed to many factors such as rounding precision, data handling, and many other internal processing nuances. However, Bland-Altman type plots showed small but randomly distributed differences across a broad range of parameters from the input data. Apart from a small subset of the parameters, there were no trends observed which would have suggested systemic differences between the languages. These analyses were based on a single set of data so more research must be done. However, based on comparing R documentation with SAS documentation, as well as the results displayed above in this paper, it is evident that the R and the SAS methods cover do produce similarly valid results for the options which were tested.\n\n### Future work\n\n-   Run SAS code by also removing assessments at `avisitn=0` from the response variable, and using `trtp` (or `trtpn`) and `avisit` (or `avisitn`)\n-   Investigating the differences\n-   Implement `lmer` equivalent to MMRM with compound symmetry\n-   Comparisons for other models, i.e. only random, random and repeated, no repeated\n",
    "supporting": [
      "r-sas_mmrm_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}