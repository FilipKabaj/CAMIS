{
  "hash": "cddd7da333a781be0ce408d0e1946b80",
  "result": {
    "markdown": "---\ntitle: \"linear-models\"\n---\n\n\n### **Getting Started**\n\nTo demonstrate the various types of sums of squares, we\\'ll create a data frame called `df_disease` taken from the SAS documentation (**reference**). For more information/to investigate this data go [here](../data-info/sas_disease.qmd)\n\n\n\n\n\n### The Model {-}\n\nFor this example, we're testing for a significant difference in `stem_length` using ANOVA.  In R, we're using `lm()` to run the ANOVA, and then using `broom::glance()` and `broom::tidy()` to view the results in a table format.\n\n\n::: {.cell hash='linear-models_cache/html/unnamed-chunk-2_729521c8665f518f29b19d88fca4244f'}\n\n```{.r .cell-code}\nlm_model <- lm(y ~ drug + disease + drug*disease, df_disease)\n```\n:::\n\n\nThe `glance` function gives us a summary of the model diagnostic values.\n\n\n::: {.cell hash='linear-models_cache/html/unnamed-chunk-3_b6664106c12c7d6db34e0e87e615806f'}\n\n```{.r .cell-code}\nlm_model %>% \n  glance() %>% \n  pivot_longer(everything())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 12 × 2\n   name               value\n   <chr>              <dbl>\n 1 r.squared        0.456  \n 2 adj.r.squared    0.326  \n 3 sigma           10.5    \n 4 statistic        3.51   \n 5 p.value          0.00130\n 6 df              11      \n 7 logLik        -212.     \n 8 AIC            450.     \n 9 BIC            477.     \n10 deviance      5081.     \n11 df.residual     46      \n12 nobs            58      \n```\n:::\n:::\n\n\nThe `tidy` function gives a summary of the model results.\n\n::: {.cell hash='linear-models_cache/html/unnamed-chunk-4_c848b9553a3f4ab61a0069326c4a9c05'}\n\n```{.r .cell-code}\nlm_model %>% tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 12 × 5\n   term           estimate std.error statistic      p.value\n   <chr>             <dbl>     <dbl>     <dbl>        <dbl>\n 1 (Intercept)      29.3        4.29    6.84   0.0000000160\n 2 drug2            -1.33       6.36   -0.210  0.835       \n 3 drug3           -13.0        7.43   -1.75   0.0869      \n 4 drug4           -15.7        6.36   -2.47   0.0172      \n 5 disease2         -1.08       6.78   -0.160  0.874       \n 6 disease3         -8.93       6.36   -1.40   0.167       \n 7 drug2:disease2    6.58       9.78    0.673  0.504       \n 8 drug3:disease2  -10.9       10.2    -1.06   0.295       \n 9 drug4:disease2    0.317      9.30    0.0340 0.973       \n10 drug2:disease3   -0.900      9.00   -0.100  0.921       \n11 drug3:disease3    1.10      10.2     0.107  0.915       \n12 drug4:disease3    9.53       9.20    1.04   0.306       \n```\n:::\n:::\n\n\n\n### The Results {-}\n\nYou'll see that R print the individual results for each level of the drug and disease interaction.  We can get the combined F table in R using the `anova()` function on the model object.\n\n::: {.cell hash='linear-models_cache/html/unnamed-chunk-5_4a6060778a20cb8b96eeb981641242cf'}\n\n```{.r .cell-code}\nlm_model %>% \n  anova() %>% \n  tidy() %>% \n  kable()\n```\n\n::: {.cell-output-display}\n|term         | df|     sumsq|    meansq| statistic|   p.value|\n|:------------|--:|---------:|---------:|---------:|---------:|\n|drug         |  3| 3133.2385| 1044.4128|  9.455761| 0.0000558|\n|disease      |  2|  418.8337|  209.4169|  1.895990| 0.1617201|\n|drug:disease |  6|  707.2663|  117.8777|  1.067225| 0.3958458|\n|Residuals    | 46| 5080.8167|  110.4525|        NA|        NA|\n:::\n:::\n\n\nWe can add a `Total` row, by using `add_row` and calculating the sum of the degrees of freedom and sum of squares.\n\n::: {.cell hash='linear-models_cache/html/unnamed-chunk-6_05217c06ceff7016617f8de1da4b0e77'}\n\n```{.r .cell-code}\nlm_model %>%\n  anova() %>%\n  tidy() %>%\n  add_row(term = \"Total\", df = sum(.$df), sumsq = sum(.$sumsq)) %>% \n  kable()\n```\n\n::: {.cell-output-display}\n|term         | df|     sumsq|    meansq| statistic|   p.value|\n|:------------|--:|---------:|---------:|---------:|---------:|\n|drug         |  3| 3133.2385| 1044.4128|  9.455761| 0.0000558|\n|disease      |  2|  418.8337|  209.4169|  1.895990| 0.1617201|\n|drug:disease |  6|  707.2663|  117.8777|  1.067225| 0.3958458|\n|Residuals    | 46| 5080.8167|  110.4525|        NA|        NA|\n|Total        | 57| 9340.1552|        NA|        NA|        NA|\n:::\n:::\n\n\n### Sums of Squares Tables  {-}\nUnfortunately, it is not easy to get the various types of sums of squares calculations in using functions from base R.  However, the `rstatix` package offers a solution to produce these various sums of squares tables. For each type, you supply the original dataset and model to the. `anova_test` function, then speccify the ttype and se `detailed = TRUE`. \n\n#### Type I\n\n::: {.cell hash='linear-models_cache/html/unnamed-chunk-7_a935e53dedbe94a4fd536494461cd840'}\n\n```{.r .cell-code}\ndf_disease %>% \n  rstatix::anova_test(\n    y ~ drug + disease + drug*disease, \n    type = 1, \n    detailed = TRUE) %>% \n  rstatix::get_anova_table() %>% \n  kable()\n```\n\n::: {.cell-output-display}\n|Effect       | DFn| DFd|      SSn|      SSd|     F|        p|p<.05 |   ges|\n|:------------|---:|---:|--------:|--------:|-----:|--------:|:-----|-----:|\n|drug         |   3|  46| 3133.239| 5080.817| 9.456| 5.58e-05|*     | 0.381|\n|disease      |   2|  46|  418.834| 5080.817| 1.896| 1.62e-01|      | 0.076|\n|drug:disease |   6|  46|  707.266| 5080.817| 1.067| 3.96e-01|      | 0.122|\n:::\n:::\n\n\n#### Type II {-}\n\n::: {.cell hash='linear-models_cache/html/unnamed-chunk-8_2df504b524cf5a700daf1f0c7f38e896'}\n\n```{.r .cell-code}\ndf_disease %>% \n  rstatix::anova_test(\n    y ~ drug + disease + drug*disease, \n    type = 2, \n    detailed = TRUE) %>% \n  rstatix::get_anova_table() %>% \n  kable()\n```\n\n::: {.cell-output-display}\n|Effect       |      SSn|      SSd| DFn| DFd|     F|        p|p<.05 |   ges|\n|:------------|--------:|--------:|---:|---:|-----:|--------:|:-----|-----:|\n|drug         | 3063.433| 5080.817|   3|  46| 9.245| 6.75e-05|*     | 0.376|\n|disease      |  418.834| 5080.817|   2|  46| 1.896| 1.62e-01|      | 0.076|\n|drug:disease |  707.266| 5080.817|   6|  46| 1.067| 3.96e-01|      | 0.122|\n:::\n:::\n\n\n\n#### Type III {-}\n\n::: {.cell hash='linear-models_cache/html/unnamed-chunk-9_ed45a123dbeceefb6b6042fedfd215c2'}\n\n```{.r .cell-code}\ndf_disease %>% \n  rstatix::anova_test(\n    y ~ drug + disease + drug*disease, \n    type = 3, \n    detailed = TRUE) %>% \n  rstatix::get_anova_table() %>% \n  kable()\n```\n\n::: {.cell-output-display}\n|Effect       |       SSn|      SSd| DFn| DFd|       F|        p|p<.05 |   ges|\n|:------------|---------:|--------:|---:|---:|-------:|--------:|:-----|-----:|\n|(Intercept)  | 20037.613| 5080.817|   1|  46| 181.414| 0.00e+00|*     | 0.798|\n|drug         |  2997.472| 5080.817|   3|  46|   9.046| 8.09e-05|*     | 0.371|\n|disease      |   415.873| 5080.817|   2|  46|   1.883| 1.64e-01|      | 0.076|\n|drug:disease |   707.266| 5080.817|   6|  46|   1.067| 3.96e-01|      | 0.122|\n:::\n:::\n\n\n\n#### Type IV {-}\nIn R there is no equivalent operation to the `Type IV` sums of squares calculation in SAS.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}